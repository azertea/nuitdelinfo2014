-- MySQL Script generated by MySQL Workbench
-- 12/04/14 21:32:56
-- Model: New Model    Version: 1.0
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema Nuitdelinfo2014
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `Nuitdelinfo2014` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `Nuitdelinfo2014` ;

-- -----------------------------------------------------
-- Table `Nuitdelinfo2014`.`UserPublic`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Nuitdelinfo2014`.`UserPublic` (
  `idUserPublic` INT NOT NULL,
  `login` VARCHAR(45) NULL,
  `pwd` VARCHAR(45) NULL,
  `email` VARCHAR(45) NULL,
  PRIMARY KEY (`idUserPublic`))
ENGINE = InnoDB
COMMENT = 'Tout utilisateur peut s\'enregistrer pour rechercher des membres.';


-- -----------------------------------------------------
-- Table `Nuitdelinfo2014`.`UserONG`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Nuitdelinfo2014`.`UserONG` (
  `idUserONG` INT NOT NULL,
  `login` VARCHAR(45) NULL,
  `pwd` VARCHAR(45) NULL,
  `email` VARCHAR(45) NULL,
  PRIMARY KEY (`idUserONG`))
ENGINE = InnoDB
COMMENT = 'Ce profil correspond à l\'ordinateur du refuge, il contient des informations de connexion.';


-- -----------------------------------------------------
-- Table `Nuitdelinfo2014`.`Recherche`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Nuitdelinfo2014`.`Recherche` (
  `idRecherche` INT NOT NULL,
  `keywordDesc` VARCHAR(300) NULL,
  `keywordLoc` VARCHAR(300) NULL,
  `UserPublic_idUserPublic` INT NOT NULL,
  PRIMARY KEY (`idRecherche`, `UserPublic_idUserPublic`),
  INDEX `fk_Recherche_UserPublic1_idx` (`UserPublic_idUserPublic` ASC),
  CONSTRAINT `fk_Recherche_UserPublic1`
    FOREIGN KEY (`UserPublic_idUserPublic`)
    REFERENCES `Nuitdelinfo2014`.`UserPublic` (`idUserPublic`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = 'Contient les informations liées à une recherche par un chercheur.';


-- -----------------------------------------------------
-- Table `Nuitdelinfo2014`.`RechercheONG`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Nuitdelinfo2014`.`RechercheONG` (
  `idRechercheONG` INT NOT NULL,
  `keywordDesc` VARCHAR(300) NULL,
  `keywordLoc` VARCHAR(300) NULL,
  `UserONG_idUserONG` INT NOT NULL,
  PRIMARY KEY (`idRechercheONG`, `UserONG_idUserONG`),
  INDEX `fk_RechercheONG_UserONG1_idx` (`UserONG_idUserONG` ASC),
  CONSTRAINT `fk_RechercheONG_UserONG1`
    FOREIGN KEY (`UserONG_idUserONG`)
    REFERENCES `Nuitdelinfo2014`.`UserONG` (`idUserONG`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = 'Contient les informations liées à une recherche par une ONG.';


-- -----------------------------------------------------
-- Table `Nuitdelinfo2014`.`Refuge`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Nuitdelinfo2014`.`Refuge` (
  `idRefuge` INT NOT NULL,
  `GPS` VARCHAR(45) NULL,
  `UserONG_idUserONG` INT NOT NULL,
  PRIMARY KEY (`idRefuge`, `UserONG_idUserONG`),
  INDEX `fk_Refuge_UserONG1_idx` (`UserONG_idUserONG` ASC),
  CONSTRAINT `fk_Refuge_UserONG1`
    FOREIGN KEY (`UserONG_idUserONG`)
    REFERENCES `Nuitdelinfo2014`.`UserONG` (`idUserONG`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = 'Cette table permet de stockre les coordonnées GPS d\'un refuge';


-- -----------------------------------------------------
-- Table `Nuitdelinfo2014`.`Profil`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Nuitdelinfo2014`.`Profil` (
  `idProfil` INT NOT NULL,
  `nom` VARCHAR(45) NULL,
  `prenom` VARCHAR(45) NULL,
  `descPhysique` VARCHAR(300) NULL,
  `localisation` VARCHAR(45) NULL,
  `telephone` VARCHAR(45) NULL,
  `Refuge_idRefuge` INT NOT NULL,
  `Refuge_UserONG_idUserONG` INT NOT NULL,
  `UserONG_idUserONG` INT NOT NULL,
  `UserPublic_idUserPublic` INT NOT NULL,
  PRIMARY KEY (`idProfil`, `Refuge_idRefuge`, `Refuge_UserONG_idUserONG`, `UserONG_idUserONG`, `UserPublic_idUserPublic`),
  INDEX `fk_Profil_Refuge1_idx` (`Refuge_idRefuge` ASC, `Refuge_UserONG_idUserONG` ASC),
  INDEX `fk_Profil_UserONG1_idx` (`UserONG_idUserONG` ASC),
  INDEX `fk_Profil_UserPublic1_idx` (`UserPublic_idUserPublic` ASC),
  CONSTRAINT `fk_Profil_Refuge1`
    FOREIGN KEY (`Refuge_idRefuge` , `Refuge_UserONG_idUserONG`)
    REFERENCES `Nuitdelinfo2014`.`Refuge` (`idRefuge` , `UserONG_idUserONG`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Profil_UserONG1`
    FOREIGN KEY (`UserONG_idUserONG`)
    REFERENCES `Nuitdelinfo2014`.`UserONG` (`idUserONG`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Profil_UserPublic1`
    FOREIGN KEY (`UserPublic_idUserPublic`)
    REFERENCES `Nuitdelinfo2014`.`UserPublic` (`idUserPublic`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = 'Cette classe regroupe les informations correspondantes aux profils recherchés.';


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
